<p>We built a neural theorem prover for  that learned to solve a variety of challenging high-school olympiad problems, including problems from the  and  competitions, as well as two problems adapted from the .<br>The prover uses a language model to find proofs of formal statements.<br>Each time we find a new proof, we use it as new training data, which improves the neural network and enables it to iteratively find solutions to harder and harder statements.We achieved a new state-of-the-art (41.2% vs 29.3%) on the  benchmark, a challenging collection of high-school olympiad problems.<br>Our approach, which we call , consists of manually collecting a set of statements of varying difficulty levels (without proof) where the hardest statements are similar to the benchmark we target.<br>Initially our neural prover is weak and can only prove a few of them.<br>We iteratively search for new proofs and re-train our neural network on the newly discovered proofs, and after 8 iterations, our prover ends up being vastly superior when tested on miniF2F.Formal mathematics is an exciting domain to study because of (i) its richness, letting you prove arbitrary theorems which require reasoning, creativity and insight and (ii) its similarity to games—where AI has been spectacularly successful—in that it has an automated way of determining whether a proof is successful (i.e., verified by the formal system).<br>As demonstrated in the trivial example below, proving a formal statement requires generating a sequence of proof steps, each proof step consisting in a call to a tactic.<br>These tactics take mathematical terms as arguments and each tactic call will transform the current statement to prove, into statements that are easier to prove, until nothing is left to prove.Since $x < 2$, $|x - 2| = -(x - 2)$.<br>Using $p = |x - 2|$ we have $x = 2-p$ and finally $x - p = 2 - 2p$.We observe that the capability to generate original mathematical terms required as arguments of tactics, which cannot be done without a neural language model, emerges from our training procedure.<br>The proof below is an example of it: the proof step  (entirely generated by our models) proposes to use  as a solution, the rest of the formal proof relying on the  tactic to verify that it is indeed valid.Expanding the expression we get:$$((n + 2)! −(n + 1)!) / n! = ((n + 2)(n+1)n! −(n + 1)n!) / n!$$Dividing by $n!$ we obtain:$$(n+2)(n+1) - (n+1)$$Factoring $(n+1)$ we get: $(n+1)(n+2-1) = (n+1)^2$ which concludes the proof.We also observe that our models and search procedure are capable of producing proofs that chain multiple non-trivial reasoning steps.<br>In the proof below, the model starts by using contraposition leading to the existential statement ().<br>It then generates a witness for it with  and finishes the proof by leveraging the  tactic.
Let $f(x) = Ax + B$ and $g(x) = Bx + A$, where $A \ne B$.<br>If $f(g(x)) - g(f(x)) = B - A$, prove that $A + B = 0$.First we find that:$$f(g(x)) = A(Bx + A) + B = ABx + A^2 + B$$$$g(f(x)) = B(Ax + B) + A = ABx + B^2 + A$$Now we plug this back in $f(g(x)) - g(f(x)) = B - A$ and get:$$(ABx + A^2 + B) - (ABx + B^2 + A) = B - A$$That is:$$A^2 - B^2 + B - A = B - A$$Hence:$$A^2 - B^2 = (A-B)(A+B) = 0$$Since we are given that $A \ne B$, necessarily, $A + B = 0$.Our models, trained with , were able to close a variety of problems from training textbooks as well as  and  competitions, and 2 problems adapted from the .<br>We present below three examples of such generated proofs.Rearrange to get $a(a-b)(a-c) + b(b-a)(b-c) + c(c-a)(c-b) >= 0$ which is true by Schur's inequality.For $n \geq 1$ we have $a(2n-1) = a(2n)-1$.<br>Substituting this into the equation given, we get:$$(a(2)-1) + a(2) + (a(4)-1) + a(4) + … + (a(98)-1) + (a(98)) = 137$$But the left-hand side is simply $2(a2 + a4 + a6 + … + a98) - 49$, so:$$(a2 + a4 + a6 + … + a98) = (137 + 49) / 2 = 93$$
For $a, b, c$ reals, prove that $(a^2 + ab + b^2)(b^2 + bc + c^2)(c^2 + ca + a^2) \geq (ab + bc + ca)^3$.After cancelling terms appearing on both sides, we are left to prove that:$$3a^2b^2c^2 + \sum_{sym} a^3b^2c \leq \sum_{cyc} a^4bc + \sum_{cyc} (a^4b^2 + b^4c^2)$$After multiplying both sides by $2$, we can rearrange the above inequality to:$$0 \leq \sum_{cyc} (a^2b + a^2c - b^2c)^2$$which clearly holds, giving the claim.Formal mathematics involves two main challenges that make a naive application of reinforcement learning unlikely to succeed.In our work, we address the infinite action space problem by sampling actions from a language model as we search for a proof.<br>Language models have the capability to generate the tactic calls as well as the original mathematical terms often required as arguments.<br>Our basis for addressing the lack of self-play is the observation that the key role of self-play in 2-player games is to provide an unsupervised curriculum.<br>Our methodology proposes to replace this unsupervised curriculum with an auxiliary set of problem statements (without requiring proofs) of varying difficulty.<br>We empirically show that, when the difficulty of these auxiliary problems is varied enough, our training procedure is able to solve a curriculum of increasingly difficult problems, eventually generalizing to the set of problems we care about.While these results are extremely exciting, as they demonstrate that deep learning models are capable of non-trivial mathematical reasoning when interacting with a formal system, we are still very far from best-student performance on these competitions, only occasionally, rather than consistently, closing challenging olympiad problems.<br>We hope nonetheless that our work will motivate research in this domain, in particular towards the  and that the  methodology we propose will help accelerate progress in automated reasoning in general.Thanks to our paper co-authors: Igor Babuschkin, Kunhao Zheng and Mantas Baksys.Thanks to the students of the Xena Project Discord who helped us formalize proofs and statements (in particular: Antoine Labelle, Hanting Zhang, Shing Tak Lam, Paul Lezeau, Sara Diaz, Nikita Golikov, Yael Dillies, Artem Vasilyev, Ollie Perree, and Yourong Zang).Thanks in particular to Kevin Buzzard and Daniel Selsam for their support and thoughtful feedback since the very beginning of this project.These problems are not standard math exercises, they are used to let the best high-school students from the US (AMC12, AIME) or the world (IMO) compete against each other.<br>The artifacts accepted by the formal system are low-level (like assembly code) and hard for humans to produce.<br>Tactics are search procedures that generate such artifacts from higher level directives to assist formalization.<br>Addendum: It was reported to us that this formal statement has an error (it should be  instead of  in ).<br>While this error unfortunately makes the statement significantly easier than its informal version, it's an interesting example of the challenges associated with formalizing problem statements: although Lean can verify with 100% confidence that a formal proof is a correct proof of a formal statement, there is no way to automatically verify that a formal statement is "faithful" to an informal one.<br>The proof of the simplified statement remains interesting so we decided to keep it in the blog post and be explicit about it with this footnote.<br>This proof is not reported in the paper as it was found by a more recent model we are still experimenting with.<br>We decided to share it nonetheles because it's one of our favourite.<br></p>
