<p>I thought I should share this noobish thing I did yesterday, as a warning to others.TL;DR: as soon as /etc/sudoers is gone, you can't sudo.So, sudo package was upgraded, and as a result, a new config file () had to be installed, but since I have modified mine,  saved the new version as , and told me about it.This  is where pacman-specific part ends, the rest can happen on any distro, so bear with me.<br>Having compared the two files with Meld, I have decided to copy my only change (uncommented wheel group) to the new file, then rename the old file to  and then rename  to .I naively assumed that sudo would let me do this, if I just stick to the same terminal session..<br>but no.<br>The moment /etc/sudoers is gone, you can't do jack.Well, I'll just Ctrl-Alt-F3 into a TTY, log in as root and correct the situation..<br>wait, I forgot my root password :) Anyway, my storage is not encrypted or anything, so I booted from the first Linux live USB I could find (Mint LMDE, not that it matters), mounted the partition and renamed /etc/sudoers.pacnew to /etc/sudoers.So don't do this.<br>Don't let /etc/sudoers be gone, even if just temporary, or you'll lose sudo until you fix it.This is also why you should edit the sudoers file with , because it validates the file for errors before saving it.<br>If you leave it with errors it prevents you from using .Absolutely.<br>And when making changes to sudo in any way, allways keep a separate terminal window (or a tty) logged in as root just to be safe.<br>If you accidently mess up sudo, at least you have root to fix it.Or even better, .Learned this the hard way when I was a younger and dumber admin.<br>I had a brainfart and couldn't remember the command, and couldn't figure out why it wouldn't let me save my edits, so I changed the permissions on the file, made my edits, and :wq'd.<br>Tried to sudo -u and got an error.<br>Tried to sudo vim /etc/sudoers and hey, why is it throwing an error?I will never forget visudo againYou could also use , instead of logging into tty.Yes, but I have forgotten my root password, so..<br>¯\_(ツ)_/¯Try avoiding modification of packaged system config files, it will save you from the extra maintenance.In this case, the default Arch Linux packaged  contains the followingThis could be a good advice.<br>Thanks!In my defense, editing sudoers was what I was taught to do when installing Arch.Next time I'll try adding a file to /etc/sudoers.dYeah, this is the real solution for any distro.<br>If your package manager says a file needs to be overwritten but has been modified locally you should stop the package manager there, undo the local changes and make the changes in a separate file, then rerun the package manager.<br>I've tried using the package manager to merge my changes into the new file with varying success, it's really not worth it.Yup! And you can edit files in that directory with visudo as well if you specify the patch (), or check it after it has been edited with the -c flag ().<br>The last one is useful if you push sudo configurations with Ansible for example to validate the file before it actually gets created/updated.I actually merged it with Meld just fine, without issues.<br>It was only about four or five lines that changed, I think.Yeah, I could have just copied the changes from sudoers.pacnew to the existing sudoers, but since there were many changed lines, I have decided to do it the other way - copy my only change to sudoers.pacnew, then rename both files.<br>Because, hey, sudoers is an important file, I don't want to screw it up somehow ;)Never would’ve thought to do that.<br>Makes sense though.visudo was mentioned enough but why the hell did you edit the new file, even though you just found out the only difference is a single '#', meaning you could've simply kept sudoers and deleted the pacsave.<br>lol.I originally wondered that, too, but he later said that he'd only changed one line in the original version, but the new file had several changes that he didn't want to merge in.I've made a habit of running  in a terminal somewhere before doing any messing with my sudoers file, just in case.I even do it when using  because while it correctly checks the syntax of the file, it doesn't prevent you from typoing your own username.<br>(Ask me how I know!)This, always  on this occasion or similar that will require rescue boot to solve, eg meddling with sshd configuration on a remote server, preferably on tmux that you can open a new window and check if everything works correctly before closing the  windowMembersOnlineI thought I should share this noobish thing I did yesterday, as a warning to others.TL;DR: as soon as /etc/sudoers is gone, you can't sudo.So, sudo package was upgraded, and as a result, a new config file () had to be installed, but since I have modified mine,  saved the new version as , and told me about it.This  is where pacman-specific part ends, the rest can happen on any distro, so bear with me.<br>Having compared the two files with Meld, I have decided to copy my only change (uncommented wheel group) to the new file, then rename the old file to  and then rename  to .I naively assumed that sudo would let me do this, if I just stick to the same terminal session..<br>but no.<br>The moment /etc/sudoers is gone, you can't do jack.Well, I'll just Ctrl-Alt-F3 into a TTY, log in as root and correct the situation..<br>wait, I forgot my root password :) Anyway, my storage is not encrypted or anything, so I booted from the first Linux live USB I could find (Mint LMDE, not that it matters), mounted the partition and renamed /etc/sudoers.pacnew to /etc/sudoers.So don't do this.<br>Don't let /etc/sudoers be gone, even if just temporary, or you'll lose sudo until you fix it.This is also why you should edit the sudoers file with , because it validates the file for errors before saving it.<br>If you leave it with errors it prevents you from using .Absolutely.<br>And when making changes to sudo in any way, allways keep a separate terminal window (or a tty) logged in as root just to be safe.<br>If you accidently mess up sudo, at least you have root to fix it.Or even better, .Learned this the hard way when I was a younger and dumber admin.<br>I had a brainfart and couldn't remember the command, and couldn't figure out why it wouldn't let me save my edits, so I changed the permissions on the file, made my edits, and :wq'd.<br>Tried to sudo -u and got an error.<br>Tried to sudo vim /etc/sudoers and hey, why is it throwing an error?I will never forget visudo againYou could also use , instead of logging into tty.Yes, but I have forgotten my root password, so..<br>¯\_(ツ)_/¯Try avoiding modification of packaged system config files, it will save you from the extra maintenance.In this case, the default Arch Linux packaged  contains the followingThis could be a good advice.<br>Thanks!In my defense, editing sudoers was what I was taught to do when installing Arch.Next time I'll try adding a file to /etc/sudoers.dYeah, this is the real solution for any distro.<br>If your package manager says a file needs to be overwritten but has been modified locally you should stop the package manager there, undo the local changes and make the changes in a separate file, then rerun the package manager.<br>I've tried using the package manager to merge my changes into the new file with varying success, it's really not worth it.Yup! And you can edit files in that directory with visudo as well if you specify the patch (), or check it after it has been edited with the -c flag ().<br>The last one is useful if you push sudo configurations with Ansible for example to validate the file before it actually gets created/updated.I actually merged it with Meld just fine, without issues.<br>It was only about four or five lines that changed, I think.Yeah, I could have just copied the changes from sudoers.pacnew to the existing sudoers, but since there were many changed lines, I have decided to do it the other way - copy my only change to sudoers.pacnew, then rename both files.<br>Because, hey, sudoers is an important file, I don't want to screw it up somehow ;)Never would’ve thought to do that.<br>Makes sense though.visudo was mentioned enough but why the hell did you edit the new file, even though you just found out the only difference is a single '#', meaning you could've simply kept sudoers and deleted the pacsave.<br>lol.I originally wondered that, too, but he later said that he'd only changed one line in the original version, but the new file had several changes that he didn't want to merge in.I've made a habit of running  in a terminal somewhere before doing any messing with my sudoers file, just in case.I even do it when using  because while it correctly checks the syntax of the file, it doesn't prevent you from typoing your own username.<br>(Ask me how I know!)This, always  on this occasion or similar that will require rescue boot to solve, eg meddling with sshd configuration on a remote server, preferably on tmux that you can open a new window and check if everything works correctly before closing the  windowMembersOnlineI thought I should share this noobish thing I did yesterday, as a warning to others.TL;DR: as soon as /etc/sudoers is gone, you can't sudo.So, sudo package was upgraded, and as a result, a new config file () had to be installed, but since I have modified mine,  saved the new version as , and told me about it.This  is where pacman-specific part ends, the rest can happen on any distro, so bear with me.<br>Having compared the two files with Meld, I have decided to copy my only change (uncommented wheel group) to the new file, then rename the old file to  and then rename  to .I naively assumed that sudo would let me do this, if I just stick to the same terminal session..<br>but no.<br>The moment /etc/sudoers is gone, you can't do jack.Well, I'll just Ctrl-Alt-F3 into a TTY, log in as root and correct the situation..<br>wait, I forgot my root password :) Anyway, my storage is not encrypted or anything, so I booted from the first Linux live USB I could find (Mint LMDE, not that it matters), mounted the partition and renamed /etc/sudoers.pacnew to /etc/sudoers.So don't do this.<br>Don't let /etc/sudoers be gone, even if just temporary, or you'll lose sudo until you fix it.This is also why you should edit the sudoers file with , because it validates the file for errors before saving it.<br>If you leave it with errors it prevents you from using .Absolutely.<br>And when making changes to sudo in any way, allways keep a separate terminal window (or a tty) logged in as root just to be safe.<br>If you accidently mess up sudo, at least you have root to fix it.Or even better, .Learned this the hard way when I was a younger and dumber admin.<br>I had a brainfart and couldn't remember the command, and couldn't figure out why it wouldn't let me save my edits, so I changed the permissions on the file, made my edits, and :wq'd.<br>Tried to sudo -u and got an error.<br>Tried to sudo vim /etc/sudoers and hey, why is it throwing an error?I will never forget visudo againYou could also use , instead of logging into tty.Yes, but I have forgotten my root password, so..<br>¯\_(ツ)_/¯Try avoiding modification of packaged system config files, it will save you from the extra maintenance.In this case, the default Arch Linux packaged  contains the followingThis could be a good advice.<br>Thanks!In my defense, editing sudoers was what I was taught to do when installing Arch.Next time I'll try adding a file to /etc/sudoers.dYeah, this is the real solution for any distro.<br>If your package manager says a file needs to be overwritten but has been modified locally you should stop the package manager there, undo the local changes and make the changes in a separate file, then rerun the package manager.<br>I've tried using the package manager to merge my changes into the new file with varying success, it's really not worth it.Yup! And you can edit files in that directory with visudo as well if you specify the patch (), or check it after it has been edited with the -c flag ().<br>The last one is useful if you push sudo configurations with Ansible for example to validate the file before it actually gets created/updated.I actually merged it with Meld just fine, without issues.<br>It was only about four or five lines that changed, I think.Yeah, I could have just copied the changes from sudoers.pacnew to the existing sudoers, but since there were many changed lines, I have decided to do it the other way - copy my only change to sudoers.pacnew, then rename both files.<br>Because, hey, sudoers is an important file, I don't want to screw it up somehow ;)Never would’ve thought to do that.<br>Makes sense though.visudo was mentioned enough but why the hell did you edit the new file, even though you just found out the only difference is a single '#', meaning you could've simply kept sudoers and deleted the pacsave.<br>lol.I originally wondered that, too, but he later said that he'd only changed one line in the original version, but the new file had several changes that he didn't want to merge in.I've made a habit of running  in a terminal somewhere before doing any messing with my sudoers file, just in case.I even do it when using  because while it correctly checks the syntax of the file, it doesn't prevent you from typoing your own username.<br>(Ask me how I know!)This, always  on this occasion or similar that will require rescue boot to solve, eg meddling with sshd configuration on a remote server, preferably on tmux that you can open a new window and check if everything works correctly before closing the  windowMembersOnlineI thought I should share this noobish thing I did yesterday, as a warning to others.TL;DR: as soon as /etc/sudoers is gone, you can't sudo.So, sudo package was upgraded, and as a result, a new config file () had to be installed, but since I have modified mine,  saved the new version as , and told me about it.This  is where pacman-specific part ends, the rest can happen on any distro, so bear with me.<br>Having compared the two files with Meld, I have decided to copy my only change (uncommented wheel group) to the new file, then rename the old file to  and then rename  to .I naively assumed that sudo would let me do this, if I just stick to the same terminal session..<br>but no.<br>The moment /etc/sudoers is gone, you can't do jack.Well, I'll just Ctrl-Alt-F3 into a TTY, log in as root and correct the situation..<br>wait, I forgot my root password :) Anyway, my storage is not encrypted or anything, so I booted from the first Linux live USB I could find (Mint LMDE, not that it matters), mounted the partition and renamed /etc/sudoers.pacnew to /etc/sudoers.So don't do this.<br>Don't let /etc/sudoers be gone, even if just temporary, or you'll lose sudo until you fix it.This is also why you should edit the sudoers file with , because it validates the file for errors before saving it.<br>If you leave it with errors it prevents you from using .Absolutely.<br>And when making changes to sudo in any way, allways keep a separate terminal window (or a tty) logged in as root just to be safe.<br>If you accidently mess up sudo, at least you have root to fix it.Or even better, .Learned this the hard way when I was a younger and dumber admin.<br>I had a brainfart and couldn't remember the command, and couldn't figure out why it wouldn't let me save my edits, so I changed the permissions on the file, made my edits, and :wq'd.<br>Tried to sudo -u and got an error.<br>Tried to sudo vim /etc/sudoers and hey, why is it throwing an error?I will never forget visudo againYou could also use , instead of logging into tty.Yes, but I have forgotten my root password, so..<br>¯\_(ツ)_/¯Try avoiding modification of packaged system config files, it will save you from the extra maintenance.In this case, the default Arch Linux packaged  contains the followingThis could be a good advice.<br>Thanks!In my defense, editing sudoers was what I was taught to do when installing Arch.Next time I'll try adding a file to /etc/sudoers.dYeah, this is the real solution for any distro.<br>If your package manager says a file needs to be overwritten but has been modified locally you should stop the package manager there, undo the local changes and make the changes in a separate file, then rerun the package manager.<br>I've tried using the package manager to merge my changes into the new file with varying success, it's really not worth it.Yup! And you can edit files in that directory with visudo as well if you specify the patch (), or check it after it has been edited with the -c flag ().<br>The last one is useful if you push sudo configurations with Ansible for example to validate the file before it actually gets created/updated.I actually merged it with Meld just fine, without issues.<br>It was only about four or five lines that changed, I think.Yeah, I could have just copied the changes from sudoers.pacnew to the existing sudoers, but since there were many changed lines, I have decided to do it the other way - copy my only change to sudoers.pacnew, then rename both files.<br>Because, hey, sudoers is an important file, I don't want to screw it up somehow ;)Never would’ve thought to do that.<br>Makes sense though.visudo was mentioned enough but why the hell did you edit the new file, even though you just found out the only difference is a single '#', meaning you could've simply kept sudoers and deleted the pacsave.<br>lol.I originally wondered that, too, but he later said that he'd only changed one line in the original version, but the new file had several changes that he didn't want to merge in.I've made a habit of running  in a terminal somewhere before doing any messing with my sudoers file, just in case.I even do it when using  because while it correctly checks the syntax of the file, it doesn't prevent you from typoing your own username.<br>(Ask me how I know!)This, always  on this occasion or similar that will require rescue boot to solve, eg meddling with sshd configuration on a remote server, preferably on tmux that you can open a new window and check if everything works correctly before closing the  windowMembersOnlineI thought I should share this noobish thing I did yesterday, as a warning to others.TL;DR: as soon as /etc/sudoers is gone, you can't sudo.So, sudo package was upgraded, and as a result, a new config file () had to be installed, but since I have modified mine,  saved the new version as , and told me about it.This  is where pacman-specific part ends, the rest can happen on any distro, so bear with me.<br>Having compared the two files with Meld, I have decided to copy my only change (uncommented wheel group) to the new file, then rename the old file to  and then rename  to .I naively assumed that sudo would let me do this, if I just stick to the same terminal session..<br>but no.<br>The moment /etc/sudoers is gone, you can't do jack.Well, I'll just Ctrl-Alt-F3 into a TTY, log in as root and correct the situation..<br>wait, I forgot my root password :) Anyway, my storage is not encrypted or anything, so I booted from the first Linux live USB I could find (Mint LMDE, not that it matters), mounted the partition and renamed /etc/sudoers.pacnew to /etc/sudoers.So don't do this.<br>Don't let /etc/sudoers be gone, even if just temporary, or you'll lose sudo until you fix it.This is also why you should edit the sudoers file with , because it validates the file for errors before saving it.<br>If you leave it with errors it prevents you from using .Absolutely.<br>And when making changes to sudo in any way, allways keep a separate terminal window (or a tty) logged in as root just to be safe.<br>If you accidently mess up sudo, at least you have root to fix it.Or even better, .Learned this the hard way when I was a younger and dumber admin.<br>I had a brainfart and couldn't remember the command, and couldn't figure out why it wouldn't let me save my edits, so I changed the permissions on the file, made my edits, and :wq'd.<br>Tried to sudo -u and got an error.<br>Tried to sudo vim /etc/sudoers and hey, why is it throwing an error?I will never forget visudo againYou could also use , instead of logging into tty.Yes, but I have forgotten my root password, so..<br>¯\_(ツ)_/¯Try avoiding modification of packaged system config files, it will save you from the extra maintenance.In this case, the default Arch Linux packaged  contains the followingThis could be a good advice.<br>Thanks!In my defense, editing sudoers was what I was taught to do when installing Arch.Next time I'll try adding a file to /etc/sudoers.dYeah, this is the real solution for any distro.<br>If your package manager says a file needs to be overwritten but has been modified locally you should stop the package manager there, undo the local changes and make the changes in a separate file, then rerun the package manager.<br>I've tried using the package manager to merge my changes into the new file with varying success, it's really not worth it.Yup! And you can edit files in that directory with visudo as well if you specify the patch (), or check it after it has been edited with the -c flag ().<br>The last one is useful if you push sudo configurations with Ansible for example to validate the file before it actually gets created/updated.I actually merged it with Meld just fine, without issues.<br>It was only about four or five lines that changed, I think.Yeah, I could have just copied the changes from sudoers.pacnew to the existing sudoers, but since there were many changed lines, I have decided to do it the other way - copy my only change to sudoers.pacnew, then rename both files.<br>Because, hey, sudoers is an important file, I don't want to screw it up somehow ;)Never would’ve thought to do that.<br>Makes sense though.visudo was mentioned enough but why the hell did you edit the new file, even though you just found out the only difference is a single '#', meaning you could've simply kept sudoers and deleted the pacsave.<br>lol.I originally wondered that, too, but he later said that he'd only changed one line in the original version, but the new file had several changes that he didn't want to merge in.I've made a habit of running  in a terminal somewhere before doing any messing with my sudoers file, just in case.I even do it when using  because while it correctly checks the syntax of the file, it doesn't prevent you from typoing your own username.<br>(Ask me how I know!)This, always  on this occasion or similar that will require rescue boot to solve, eg meddling with sshd configuration on a remote server, preferably on tmux that you can open a new window and check if everything works correctly before closing the  windowMembersOnlineI thought I should share this noobish thing I did yesterday, as a warning to others.TL;DR: as soon as /etc/sudoers is gone, you can't sudo.So, sudo package was upgraded, and as a result, a new config file () had to be installed, but since I have modified mine,  saved the new version as , and told me about it.This  is where pacman-specific part ends, the rest can happen on any distro, so bear with me.<br>Having compared the two files with Meld, I have decided to copy my only change (uncommented wheel group) to the new file, then rename the old file to  and then rename  to .I naively assumed that sudo would let me do this, if I just stick to the same terminal session..<br>but no.<br>The moment /etc/sudoers is gone, you can't do jack.Well, I'll just Ctrl-Alt-F3 into a TTY, log in as root and correct the situation..<br>wait, I forgot my root password :) Anyway, my storage is not encrypted or anything, so I booted from the first Linux live USB I could find (Mint LMDE, not that it matters), mounted the partition and renamed /etc/sudoers.pacnew to /etc/sudoers.So don't do this.<br>Don't let /etc/sudoers be gone, even if just temporary, or you'll lose sudo until you fix it.This is also why you should edit the sudoers file with , because it validates the file for errors before saving it.<br>If you leave it with errors it prevents you from using .Absolutely.<br>And when making changes to sudo in any way, allways keep a separate terminal window (or a tty) logged in as root just to be safe.<br>If you accidently mess up sudo, at least you have root to fix it.Or even better, .Learned this the hard way when I was a younger and dumber admin.<br>I had a brainfart and couldn't remember the command, and couldn't figure out why it wouldn't let me save my edits, so I changed the permissions on the file, made my edits, and :wq'd.<br>Tried to sudo -u and got an error.<br>Tried to sudo vim /etc/sudoers and hey, why is it throwing an error?I will never forget visudo againYou could also use , instead of logging into tty.Yes, but I have forgotten my root password, so..<br>¯\_(ツ)_/¯Try avoiding modification of packaged system config files, it will save you from the extra maintenance.In this case, the default Arch Linux packaged  contains the followingThis could be a good advice.<br>Thanks!In my defense, editing sudoers was what I was taught to do when installing Arch.Next time I'll try adding a file to /etc/sudoers.dYeah, this is the real solution for any distro.<br>If your package manager says a file needs to be overwritten but has been modified locally you should stop the package manager there, undo the local changes and make the changes in a separate file, then rerun the package manager.<br>I've tried using the package manager to merge my changes into the new file with varying success, it's really not worth it.Yup! And you can edit files in that directory with visudo as well if you specify the patch (), or check it after it has been edited with the -c flag ().<br>The last one is useful if you push sudo configurations with Ansible for example to validate the file before it actually gets created/updated.I actually merged it with Meld just fine, without issues.<br>It was only about four or five lines that changed, I think.Yeah, I could have just copied the changes from sudoers.pacnew to the existing sudoers, but since there were many changed lines, I have decided to do it the other way - copy my only change to sudoers.pacnew, then rename both files.<br>Because, hey, sudoers is an important file, I don't want to screw it up somehow ;)Never would’ve thought to do that.<br>Makes sense though.visudo was mentioned enough but why the hell did you edit the new file, even though you just found out the only difference is a single '#', meaning you could've simply kept sudoers and deleted the pacsave.<br>lol.I originally wondered that, too, but he later said that he'd only changed one line in the original version, but the new file had several changes that he didn't want to merge in.I've made a habit of running  in a terminal somewhere before doing any messing with my sudoers file, just in case.I even do it when using  because while it correctly checks the syntax of the file, it doesn't prevent you from typoing your own username.<br>(Ask me how I know!)This, always  on this occasion or similar that will require rescue boot to solve, eg meddling with sshd configuration on a remote server, preferably on tmux that you can open a new window and check if everything works correctly before closing the  windowMembersOnline</p>
