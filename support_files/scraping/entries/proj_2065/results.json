[
{"title": "Hi, I'm Daniel Jakots!", "links": "https://chown.me", "content": "In this article, I'll explain how, and why I acquired an ", "images": []},
{"title": "Why and how I got my own ASN!", "links": "https://chown.me", "content": " and some\nIPv6 addresses.", "images": []},
{"title": "missing", "links": "https://chown.me/about", "content": "In late 2020, I read\n", "images": []},
{"title": "missing", "links": "https://chown.me/contact", "content": ".\nIn this post, the author said if they were to build something new, they would\nfocus on \"IPv6 only, mostly\". This post got me to thinking about having some\nIPv6 connectivity again.", "images": []},
{"title": "missing", "links": "https://chown.me/blog/feeds/atom.xml", "content": "Before I got to Montreal, I used to have access to IPv6 Internet. I can't\nremember for sure, but I think it was through a ", "images": []},
{"title": "missing", "links": "https://px.chown.me", "content": " tunnel.", "images": []},
{"title": "missing", "links": "./getting-my-own-asn", "content": "My Internet Service Provider (ISP) is a small ISP. They don't own the ", "images": []},
{"title": "missing", "links": "#intro", "content": ". They provide native IPv6 for\nsome other subscription of theirs, where they can. However, on the service I'm\nsubscribed to, the last mile owner is still ", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Autonomous_system_(Internet)", "content": "\n(", "images": []},
{"title": "missing", "links": "#cravings", "content": ").", "images": []},
{"title": "missing", "links": "https://blog.dave.tf/post/new-kubernetes/", "content": "No native IPv6 means I'll need to setup some tunnels, one way or another.", "images": []},
{"title": "missing", "links": "https://tunnelbroker.net/", "content": "The first thing I looked at was Hurrincane Electric, since it was the only\nprovider I knew at the time. Unfortunately, they only offer\n", "images": []},
{"title": "missing", "links": "#native", "content": " tunnels,\nwhich means no encryption. One could argue that in 2020+, with HTTPS and\n", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Last_mile", "content": "/", "images": []},
{"title": "missing", "links": "#tunnels", "content": ",\nthere is little unencrypted traffic, but to that I'll reply \"meh\".", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Generic_Routing_Encapsulation", "content": "I thought I could rent a virtual machine (preferably, since tunnels require\nlittle resources and VMs are way cheaper than dedicated servers) and run my own\ntunnel with the IPv6 it provides.", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/DNS_over_TLS", "content": "As mentioned in ", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/DNS_over_HTTPS", "content": ", I\nhave multiple networks (VLAN) at home. Because I didn't want to do some\n", "images": []},
{"title": "missing", "links": "#hosters", "content": " things, I needed to have a /64 per network, meaning multiple /64s for\nmy home.", "images": []},
{"title": "missing", "links": "./infrastructure-2020", "content": "I went on the hunt for a provider that offers something like a /56 (or the\noption to get multiple /64s). Unfortunately, I didn't find anything reasonable.\nI eventually found some high end servers that came with a /48 but since they\ncost nearly as much as my rent, I'll pass. Most providers give at best a /64,\nbut it can also be a /128 (lol) or nothing (yeah who cares about IPv6).", "images": []},
{"title": "missing", "links": "#other", "content": "I asked a network engineer friend if he knew any hosting services providing\nmore than a /64 with a cheap machine and -well- he gave a network-engineer type\nof answer \"just get your IPv6 addresses and announce them\".", "images": []},
{"title": "missing", "links": "#context", "content": "After inquiring more detail, he kindly answered and I decided to proceed with\nthis.", "images": []},
{"title": "missing", "links": "http://as197696.net/", "content": "While I don't qualify as a network engineer, I'm not completely ignorant\nnetwork-wise. I used to work for a ", "images": []},
{"title": "missing", "links": "https://www.ffdn.org/", "content": " (so\nI'm no stranger to BGP) and I used to be a volunteer for ", "images": []},
{"title": "missing", "links": "https://www.franciliens.net/", "content": " ", "images": []},
{"title": "missing", "links": "https://gitoyen.net/", "content": "\n", "images": []},
{"title": "missing", "links": "#resources", "content": " back in France.", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Anycast", "content": ": Keep in mind what follows is my own interpretation. Go read the\nrelevant parties' websites and agreements to make your own opinion.", "images": []},
{"title": "missing", "links": "#RIR", "content": "Following my friend's advice, I set out to get some IPv6 addresses and an ASN\nto announce them. I could then create my own (encrypted of course) tunnels to\nget IPv6 at home.", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Regional_Internet_registry", "content": "I would also be able to achieve what I had wanted for years: play with\n", "images": []},
{"title": "missing", "links": "#arin", "content": ".", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/American_Registry_for_Internet_Numbers", "content": "IP addresses and an ASN can be obtained through a\n", "images": []},
{"title": "missing", "links": "#ripe", "content": ".", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/RIPE_NCC", "content": "Because of my personal situation (which I won't get into), there are two RIRs I\ncould ask: ARIN and the RIPE.", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Regional_Internet_registry#Local_Internet_registry", "content": " is\nthe RIR for Corporatist America. If you're not a corporation, well you're not\ngoing to go very far.", "images": []},
{"title": "missing", "links": "#grifon", "content": "I considered creating my own, but the cost exceeded what I was ready to spend\non the project. As affordable as it would have been for a corporation, it would\nnot be for me.", "images": []},
{"title": "missing", "links": "https://grifon.fr/", "content": " is the RIR for Socialist Europe.\nYou're an individual and you want some resources? That's totally fine, go ask\nfor some. Well, not directly. RIPE doesn't talk to peasants, you'll have to ask\na\n", "images": []},
{"title": "missing", "links": "#obtaining", "content": ".\nIf they can provide it directly, they do.  Otherwise, they act as a proxy\nbetween you and the RIPE.", "images": []},
{"title": "missing", "links": "https://bgp.he.net/net/2001:67c:291c::/48", "content": "I went for this option. From my time volunteering, I know quite a lot of people\nin quite a lot of LIRs.", "images": []},
{"title": "missing", "links": "https://bgp.he.net/AS211935", "content": "I chose ", "images": []},
{"title": "missing", "links": "https://www.swordarmor.fr/", "content": " for no particular reason.", "images": []},
{"title": "missing", "links": "https://bgp.he.net/net/2a0e:f43::/48", "content": "My initial plan was to get a /48 to get IPv6 at home and a /48 to play with\nanycast (because it is the smallest network you can announce on the Internet).\nI couldn't do anything else with the /48 I would anycast, by design.", "images": []},
{"title": "missing", "links": "https://www.ripe.net/participate/member-support/copy_of_faqs/isp-related-questions/pa-pi", "content": "So after completing my membership, I requested a /48 IPv6 from the RIPE\n(through my LIR, as explained). A few days after the request and with some\nfollow-up questions, I got ", "images": []},
{"title": "missing", "links": "#feda", "content": ". Now that I had some address\nspace, I could justify the need for an ASN. I made the request and got\n", "images": []},
{"title": "missing", "links": "https://www.iucc.ac.il/en/blog/2021-05-google-geo-location/", "content": ".", "images": []},
{"title": "missing", "links": "https://igwan.net/", "content": "So I requested a /48 to my LIR from its own resources.\n", "images": []},
{"title": "missing", "links": "https://internet.nat.moe/", "content": " kindly carved ", "images": []},
{"title": "missing", "links": "https://twitter.com/stahnma/status/634849376343429120", "content": " out of the LIR reserved address\nspace for this purpose.", "images": []},
{"title": "missing", "links": "#IPAM", "content": "(For the readers not versed in the RIPE-world technicalities, ", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/IP_address_management", "content": ").", "images": []},
{"title": "missing", "links": "https://github.com/netbox-community/netbox", "content": "Shortly after I setup IPv6 at home, I noticed Google believed I was in France.\n", "images": []},
{"title": "missing", "links": "https://lobste.rs/s/95hsvw/stupid_light_software#c_1n5zrk", "content": ", I had\nno hope for myself. I thought that maybe using a netblock from ARIN would solve\nmy issue.", "images": []},
{"title": "missing", "links": "https://lobste.rs/s/lrphxy/designing_low_upkeep_software#c_pjyzfd", "content": "At first, I went to ask ", "images": []},
{"title": "missing", "links": "#IPAM1", "content": ", but\nit didn't work because we hit a technical limitation from a common provider.", "images": []},
{"title": "missing", "links": "#IPAM2", "content": "Then, I found the ", "images": []},
{"title": "missing", "links": "#infrastructure", "content": ". They\nprovide a /48 (or more if you can justify the need) out of a netblock called\nfeda (because it comes from ", "images": []},
{"title": "missing", "links": "#anycast", "content": ").", "images": []},
{"title": "missing", "links": "https://datatracker.ietf.org/doc/html/rfc7511", "content": "Unfortunately, this didn't solve my geolocation problem with Google. I even had\na new problem, my FEDA block was geolocated in China, but I easily fixed it in\nmaxmind db, and it seems to have been enough.", "images": []},
{"title": "missing", "links": "#athome", "content": "However, as the quote says ", "images": []},
{"title": "missing", "links": "https://man.openbsd.org/wg", "content": ", I had now a /48 I\ncould use to test stuff for anycast.", "images": []},
{"title": "missing", "links": "https://www.bgp.us/routing-table/full-bgp-table-benefits-and-dangers/", "content": "Now that I had 3 netblocks that I was going to cut into smaller networks, I\nwould need a ", "images": []},
{"title": "missing", "links": "https://blog.cloudflare.com/analysis-of-todays-centurylink-level-3-outage/", "content": ". Nowadays, most\npeople use ", "images": []},
{"title": "missing", "links": "https://man.openbsd.org/pf", "content": ". I thought I\nwas going to use it, but I read a\n", "images": []},
{"title": "missing", "links": "https://man.openbsd.org/ospf6d", "content": " of\n", "images": []},
{"title": "missing", "links": "https://man.openbsd.org/eigrpd", "content": " the\nauthor of sidekiq and it made me realize I didn't need such a complex tool.", "images": []},
{"title": "missing", "links": "https://man.openbsd.org/bgpd", "content": "For shits and giggles, I initially thought \"wouldn't it be nice to use tree(1)\nto see everything??\". I created directories for blocks, and files for\naddresses. Here's what it looked like:", "images": []},
{"title": "missing", "links": "#software", "content": "Note: This predates the move to the feda netblock.", "images": []},
{"title": "missing", "links": "https://www.openbgpd.org/", "content": "However in the end, editing files was not easy because I had to escape all the\n", "images": []},
{"title": "missing", "links": "https://rpki-client.org/", "content": " in my shell. I had a lot of fun creating this arborescence, but it was time\nto move on to something more practical.", "images": []},
{"title": "missing", "links": "#rpki", "content": "I went for a single text file in a json-inspired format. Here's what it looks\nlike:", "images": []},
{"title": "missing", "links": "https://man.openbsd.org/rpki-client", "content": "Note that here RTBH is ", "images": []},
{"title": "missing", "links": "https://datatracker.ietf.org/doc/html/rfc8210", "content": " how I named the network, it's not related to\nactual RTBH.", "images": []},
{"title": "missing", "links": "https://github.com/cloudflare/gortr", "content": "I manage the file with vim and I can easily (un)fold any level whether I want\nan overview or a detailed view. Also this may not be entirely up to date haha.", "images": []},
{"title": "missing", "links": "https://github.com/bgp/stayrtr", "content": "My initial plan was to get some VMs around the world and announce the /48 on\neach.  Easier said than done, because my requirements are to find a provider\nwhich:", "images": []},
{"title": "missing", "links": "#contributions", "content": "I thought \"anycast is easy, you just announce your IP everywhere, and done\".\nWell, yes, but actually no. At least if you don't want to abide by ", "images": []},
{"title": "missing", "links": "https://github.com/openbsd/src/commit/d5980c09d2040665450fb05dc517f02f9059b40f", "content": ". Proper routing requires a\nlot of work.", "images": []},
{"title": "missing", "links": "https://github.com/openbsd/src/commit/7d9b2f2f77bea0095e5af3377fe49c9b1ba47384", "content": "I currently have 4 VMs in this anycast network:", "images": []},
{"title": "missing", "links": "https://github.com/openbsd/src/commit/25b45e4dc40bdb93a2214908573405fd6d7e5dc5", "content": "This is a work in progress that probably deserves its own blog post when it's\nfully done, so I won't go further into details.", "images": []},
{"title": "missing", "links": "https://github.com/openbsd/src/commit/f2c1f8a9d7d9a1bd6d0f1bd24202767c14a55827", "content": "As you just read, I have two VMs in Toronto. I wish I could have a provider in\nMontreal to reduce latency, unfortunately I've not been able to find one quite\nyet.", "images": []},
{"title": "missing", "links": "https://github.com/openbsd/ports/commit/824909a45fdb9566129f108c664aacfa148d71ca", "content": "I had to choose some tunnelling technology. I picked up WireGuard\u00ae because it\nhad recently made it into OpenBSD kernels (see\n", "images": []},
{"title": "missing", "links": "https://github.com/openbsd/src/commit/40192866049d58ca33971afdcb144fab8b38563c", "content": ") and my experience with ipsec is as \"good\"\nas the next person.", "images": []},
{"title": "missing", "links": "#cost", "content": "My current setup is:", "images": []},
{"title": "missing", "links": "#admincost", "content": "R1 and R2 are my VMs in Toronto, and R3 is my router at home. Yes, my router at\nhome uses BGP, both to announce its own netblock over BGP and to choose the\nbest route between R1+Upstream 1 and R2+Upstream 2. Isn't that super cool??! :D", "images": []},
{"title": "missing", "links": "#hostingcost", "content": "R1 and R2 both announce my /48 to their provider. They do so with my public\nASN.", "images": []},
{"title": "missing", "links": "https://evolix.com/", "content": "They have a wg link between each other. The goal is twofold:", "images": []},
{"title": "missing", "links": "#resources", "content": "Case 1 isn't actually a problem. Once the session with the upstream fails, it\nwon't get the ", "images": []},
{"title": "missing", "links": "#te", "content": "\nanymore, which means R3 won't get the full view from that router, and it will\n", "images": []},
{"title": "missing", "links": "https://www.youtube.com/watch?v=1pi18uNqsO4&list=PLjVwd8FlHBAQk5U2ScrjpeRJujGTCaMfR", "content": " traffic only to the other. Traffic ", "images": []},
{"title": "missing", "links": "https://nsrc.org/", "content": " will switch automatically\nprovided the upstream stops announcing my route (it should, but ", "images": []},
{"title": "missing", "links": "#findinghosters", "content": ")", "images": []},
{"title": "missing", "links": "http://bgp.services", "content": "I prepend that path with my ASN 15 times (picked by \"should be good enough\nlol\") to avoid using it in normal condition.", "images": []},
{"title": "missing", "links": "#shouldyoudoit", "content": "This simple link was actually quite a big change because until then, R1 and R2\nused to do some stateful firewalling (in addition to the one done on R3).\nHowever, this change meant traffic could flow asymmetrically, so I had to\nswitch to stateless firewall (which I restricted to the specific network, the\nrest of the traffic is still checked by ", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Content-addressable_memory#Ternary_CAMs", "content": "\nwith stateful rules).", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Default-free_zone", "content": "R3 announces the /56 I have at home over BGP to R1 and R2. \"But this is inter\nAS, why didn't you use an IGP???\". Well wg(4) doesn't support multicast, and\n", "images": []},
{"title": "missing", "links": "https://dn42.eu/Home", "content": " (and even\n", "images": []},
{"title": "missing", "links": "#outro", "content": ") needs it. You can do without\nbuuuut... I tried and struggled with ospf6d, so sticking with\n", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Black_hole_(networking)#Black_hole_filtering", "content": " was way easier.", "images": []},
{"title": "missing", "links": "https://github.com/danieljakots/chownmeblog", "content": "Fun fact: I even began to write my own igpd, but I quickly realized I was just\nreimplementing bgpd poorly so I aborted.", "images": []},
{"title": "missing", "links": "missing", "content": "I actually use a private ASN to announce the /56. I picked 4200211935, so it's\nobviously both \"it's my ASN\", and \"it's not ", "images": []},
{"title": "missing", "links": "missing", "content": "\":", "images": []},
{"title": "missing", "links": "missing", "content": "Of course since I announce a /56 and a private ASN, I needed to stop checking\nRPKI for this particular host. Fortunately, bgpd's rules system is really easy\nto work with.", "images": []},
{"title": "missing", "links": "missing", "content": "Of course everything runs OpenBSD! It has a lovely\n", "images": []},
{"title": "missing", "links": "missing", "content": " in base. OpenBSD ships\n", "images": []},
{"title": "missing", "links": "missing", "content": " which one can use to validate ROA\n(\"improve the routing security\" in layman's terms).", "images": []},
{"title": "missing", "links": "missing", "content": "OpenBSD developers changed OpenBGPD config since last I used it. The thing I\nworry the most about is messing what I announce to my peers. They must have\nfilters, but I don't want to be ", "images": []},
{"title": "missing", "links": "missing", "content": ". OpenBGPD's config file is set in a\nway that it's hard to mess up, thanks to sane defaults and a nice logic.", "images": []},
{"title": "missing", "links": "missing", "content": "It ships with an excellent example config file making easy to start using it!\nFor that reason, I'm not going to detail mine.", "images": []},
{"title": "missing", "links": "missing", "content": "OpenBGPD uses little memory:", "images": []},
{"title": "missing", "links": "missing", "content": "Most VMs have only 1G of ram and 1 cpu.", "images": []},
{"title": "missing", "links": "missing", "content": "I didn't want to run ", "images": []},
{"title": "missing", "links": "missing", "content": " on each\nand every router. I couldn't either because it uses a truckload of inodes and\nmy /var/ partitions couldn't afford it.", "images": []},
{"title": "missing", "links": "missing", "content": "I considered using ", "images": []},
{"title": "missing", "links": "missing", "content": ",\nhowever it meant running more software (e.g.\n", "images": []},
{"title": "missing", "links": "missing", "content": "/", "images": []},
{"title": "missing", "links": "missing", "content": ").", "images": []},
{"title": "missing", "links": "missing", "content": "Also bgpd doesn't support (yet?) encrypted RTR so it would have meant either\ndoing RTR unecrypted (yuck), or run even more software.", "images": []},
{"title": "missing", "links": "missing", "content": "What I ended up doing is running rpki-client on my web server (on which I added\na special partion with way more inodes).", "images": []},
{"title": "missing", "links": "missing", "content": "And on my bgpd routers", "images": []},
{"title": "missing", "links": "missing", "content": "15 minutes ought to be enough, it used to run in 5 minutes, but apparently it\nnow runs in around 8 minutes, I guess I should setup some monitoring haha.", "images": []},
{"title": "missing", "links": "missing", "content": "Of course, I found some improvements for the software I use through this\nproject. Here are some fixes that made it into the OpenBSD trees because of my\nplaying around:", "images": []},
{"title": "missing", "links": "missing", "content": "Of course this weird hobby of mine costs money. I'm however very happy of how\nlow I could keep my expenses.", "images": []},
{"title": "missing", "links": "missing", "content": "Here's what I paid Grifon:", "images": []},
{"title": "missing", "links": "missing", "content": "Out of 4 VMs I run BGP on, I've been using one for other things, so I'm not\ncounting it since I would pay for it regardless of this project.", "images": []},
{"title": "missing", "links": "missing", "content": "Here's what I pay for the host:", "images": []},
{"title": "missing", "links": "missing", "content": "Even if I messed around with BGP before, I hadn't really gone deeper than the\nsurface. Since I had a lot to learn network engineering-wise, I read a lot of\nstuff. Among everything, I highly recommend the ", "images": []},
{"title": "missing", "links": "missing", "content": "\nfrom ", "images": []},
{"title": "missing", "links": "missing", "content": "The Google Docs ", "images": []},
{"title": "missing", "links": "missing", "content": " was\nincredibly helpful.", "images": []},
{"title": "missing", "links": "missing", "content": "Probably no.", "images": []},
{"title": "missing", "links": "missing", "content": "While the resources I'm using are plentiful (32-bit ASNs, 128-bit IP\naddresses), people's routers\n", "images": []},
{"title": "missing", "links": "missing", "content": "\nare not.", "images": []},
{"title": "missing", "links": "missing", "content": "My 'experiment' is 3 netblocks out of the ~130k in the\n", "images": []},
{"title": "missing", "links": "missing", "content": ".", "images": []},
{"title": "missing", "links": "missing", "content": "Note that I'm definitely not the first person to get an ASN for personal use.\nOnce you begin looking into ASN, there are plenty.", "images": []},
{"title": "missing", "links": "missing", "content": "If you really want to play with BGP, you can look into\n", "images": []},
{"title": "missing", "links": "missing", "content": "!", "images": []},
{"title": "missing", "links": "missing", "content": "I've been doing this project for a bit over a year now.", "images": []},
{"title": "missing", "links": "missing", "content": "There were some boring tasks (the perpetual quest to find hosters who don't\nsuck, administrative things to get the resources, etc), but overall, this\nproject has been incredibly fun!", "images": []},
{"title": "missing", "links": "missing", "content": "Yeah sex is good, but have you tried running mtr(8), while shutting a BGP\nsession, or ", "images": []},
{"title": "missing", "links": "missing", "content": "\nand watch the traffic change?", "images": []},
{"title": "missing", "links": "missing", "content": "This website is best viewed on a screen identical to my own. ", "images": []}
][
{"title": "Hi, I'm Daniel Jakots!", "links": "https://chown.me", "content": "In this article, I'll explain how, and why I acquired an ", "images": []},
{"title": "Why and how I got my own ASN!", "links": "https://chown.me", "content": " and some\nIPv6 addresses.", "images": []},
{"title": "missing", "links": "https://chown.me/about", "content": "In late 2020, I read\n", "images": []},
{"title": "missing", "links": "https://chown.me/contact", "content": ".\nIn this post, the author said if they were to build something new, they would\nfocus on \"IPv6 only, mostly\". This post got me to thinking about having some\nIPv6 connectivity again.", "images": []},
{"title": "missing", "links": "https://chown.me/blog/feeds/atom.xml", "content": "Before I got to Montreal, I used to have access to IPv6 Internet. I can't\nremember for sure, but I think it was through a ", "images": []},
{"title": "missing", "links": "https://px.chown.me", "content": " tunnel.", "images": []},
{"title": "missing", "links": "./getting-my-own-asn", "content": "My Internet Service Provider (ISP) is a small ISP. They don't own the ", "images": []},
{"title": "missing", "links": "#intro", "content": ". They provide native IPv6 for\nsome other subscription of theirs, where they can. However, on the service I'm\nsubscribed to, the last mile owner is still ", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Autonomous_system_(Internet)", "content": "\n(", "images": []},
{"title": "missing", "links": "#cravings", "content": ").", "images": []},
{"title": "missing", "links": "https://blog.dave.tf/post/new-kubernetes/", "content": "No native IPv6 means I'll need to setup some tunnels, one way or another.", "images": []},
{"title": "missing", "links": "https://tunnelbroker.net/", "content": "The first thing I looked at was Hurrincane Electric, since it was the only\nprovider I knew at the time. Unfortunately, they only offer\n", "images": []},
{"title": "missing", "links": "#native", "content": " tunnels,\nwhich means no encryption. One could argue that in 2020+, with HTTPS and\n", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Last_mile", "content": "/", "images": []},
{"title": "missing", "links": "#tunnels", "content": ",\nthere is little unencrypted traffic, but to that I'll reply \"meh\".", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Generic_Routing_Encapsulation", "content": "I thought I could rent a virtual machine (preferably, since tunnels require\nlittle resources and VMs are way cheaper than dedicated servers) and run my own\ntunnel with the IPv6 it provides.", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/DNS_over_TLS", "content": "As mentioned in ", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/DNS_over_HTTPS", "content": ", I\nhave multiple networks (VLAN) at home. Because I didn't want to do some\n", "images": []},
{"title": "missing", "links": "#hosters", "content": " things, I needed to have a /64 per network, meaning multiple /64s for\nmy home.", "images": []},
{"title": "missing", "links": "./infrastructure-2020", "content": "I went on the hunt for a provider that offers something like a /56 (or the\noption to get multiple /64s). Unfortunately, I didn't find anything reasonable.\nI eventually found some high end servers that came with a /48 but since they\ncost nearly as much as my rent, I'll pass. Most providers give at best a /64,\nbut it can also be a /128 (lol) or nothing (yeah who cares about IPv6).", "images": []},
{"title": "missing", "links": "#other", "content": "I asked a network engineer friend if he knew any hosting services providing\nmore than a /64 with a cheap machine and -well- he gave a network-engineer type\nof answer \"just get your IPv6 addresses and announce them\".", "images": []},
{"title": "missing", "links": "#context", "content": "After inquiring more detail, he kindly answered and I decided to proceed with\nthis.", "images": []},
{"title": "missing", "links": "http://as197696.net/", "content": "While I don't qualify as a network engineer, I'm not completely ignorant\nnetwork-wise. I used to work for a ", "images": []},
{"title": "missing", "links": "https://www.ffdn.org/", "content": " (so\nI'm no stranger to BGP) and I used to be a volunteer for ", "images": []},
{"title": "missing", "links": "https://www.franciliens.net/", "content": " ", "images": []},
{"title": "missing", "links": "https://gitoyen.net/", "content": "\n", "images": []},
{"title": "missing", "links": "#resources", "content": " back in France.", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Anycast", "content": ": Keep in mind what follows is my own interpretation. Go read the\nrelevant parties' websites and agreements to make your own opinion.", "images": []},
{"title": "missing", "links": "#RIR", "content": "Following my friend's advice, I set out to get some IPv6 addresses and an ASN\nto announce them. I could then create my own (encrypted of course) tunnels to\nget IPv6 at home.", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Regional_Internet_registry", "content": "I would also be able to achieve what I had wanted for years: play with\n", "images": []},
{"title": "missing", "links": "#arin", "content": ".", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/American_Registry_for_Internet_Numbers", "content": "IP addresses and an ASN can be obtained through a\n", "images": []},
{"title": "missing", "links": "#ripe", "content": ".", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/RIPE_NCC", "content": "Because of my personal situation (which I won't get into), there are two RIRs I\ncould ask: ARIN and the RIPE.", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Regional_Internet_registry#Local_Internet_registry", "content": " is\nthe RIR for Corporatist America. If you're not a corporation, well you're not\ngoing to go very far.", "images": []},
{"title": "missing", "links": "#grifon", "content": "I considered creating my own, but the cost exceeded what I was ready to spend\non the project. As affordable as it would have been for a corporation, it would\nnot be for me.", "images": []},
{"title": "missing", "links": "https://grifon.fr/", "content": " is the RIR for Socialist Europe.\nYou're an individual and you want some resources? That's totally fine, go ask\nfor some. Well, not directly. RIPE doesn't talk to peasants, you'll have to ask\na\n", "images": []},
{"title": "missing", "links": "#obtaining", "content": ".\nIf they can provide it directly, they do.  Otherwise, they act as a proxy\nbetween you and the RIPE.", "images": []},
{"title": "missing", "links": "https://bgp.he.net/net/2001:67c:291c::/48", "content": "I went for this option. From my time volunteering, I know quite a lot of people\nin quite a lot of LIRs.", "images": []},
{"title": "missing", "links": "https://bgp.he.net/AS211935", "content": "I chose ", "images": []},
{"title": "missing", "links": "https://www.swordarmor.fr/", "content": " for no particular reason.", "images": []},
{"title": "missing", "links": "https://bgp.he.net/net/2a0e:f43::/48", "content": "My initial plan was to get a /48 to get IPv6 at home and a /48 to play with\nanycast (because it is the smallest network you can announce on the Internet).\nI couldn't do anything else with the /48 I would anycast, by design.", "images": []},
{"title": "missing", "links": "https://www.ripe.net/participate/member-support/copy_of_faqs/isp-related-questions/pa-pi", "content": "So after completing my membership, I requested a /48 IPv6 from the RIPE\n(through my LIR, as explained). A few days after the request and with some\nfollow-up questions, I got ", "images": []},
{"title": "missing", "links": "#feda", "content": ". Now that I had some address\nspace, I could justify the need for an ASN. I made the request and got\n", "images": []},
{"title": "missing", "links": "https://www.iucc.ac.il/en/blog/2021-05-google-geo-location/", "content": ".", "images": []},
{"title": "missing", "links": "https://igwan.net/", "content": "So I requested a /48 to my LIR from its own resources.\n", "images": []},
{"title": "missing", "links": "https://internet.nat.moe/", "content": " kindly carved ", "images": []},
{"title": "missing", "links": "https://twitter.com/stahnma/status/634849376343429120", "content": " out of the LIR reserved address\nspace for this purpose.", "images": []},
{"title": "missing", "links": "#IPAM", "content": "(For the readers not versed in the RIPE-world technicalities, ", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/IP_address_management", "content": ").", "images": []},
{"title": "missing", "links": "https://github.com/netbox-community/netbox", "content": "Shortly after I setup IPv6 at home, I noticed Google believed I was in France.\n", "images": []},
{"title": "missing", "links": "https://lobste.rs/s/95hsvw/stupid_light_software#c_1n5zrk", "content": ", I had\nno hope for myself. I thought that maybe using a netblock from ARIN would solve\nmy issue.", "images": []},
{"title": "missing", "links": "https://lobste.rs/s/lrphxy/designing_low_upkeep_software#c_pjyzfd", "content": "At first, I went to ask ", "images": []},
{"title": "missing", "links": "#IPAM1", "content": ", but\nit didn't work because we hit a technical limitation from a common provider.", "images": []},
{"title": "missing", "links": "#IPAM2", "content": "Then, I found the ", "images": []},
{"title": "missing", "links": "#infrastructure", "content": ". They\nprovide a /48 (or more if you can justify the need) out of a netblock called\nfeda (because it comes from ", "images": []},
{"title": "missing", "links": "#anycast", "content": ").", "images": []},
{"title": "missing", "links": "https://datatracker.ietf.org/doc/html/rfc7511", "content": "Unfortunately, this didn't solve my geolocation problem with Google. I even had\na new problem, my FEDA block was geolocated in China, but I easily fixed it in\nmaxmind db, and it seems to have been enough.", "images": []},
{"title": "missing", "links": "#athome", "content": "However, as the quote says ", "images": []},
{"title": "missing", "links": "https://man.openbsd.org/wg", "content": ", I had now a /48 I\ncould use to test stuff for anycast.", "images": []},
{"title": "missing", "links": "https://www.bgp.us/routing-table/full-bgp-table-benefits-and-dangers/", "content": "Now that I had 3 netblocks that I was going to cut into smaller networks, I\nwould need a ", "images": []},
{"title": "missing", "links": "https://blog.cloudflare.com/analysis-of-todays-centurylink-level-3-outage/", "content": ". Nowadays, most\npeople use ", "images": []},
{"title": "missing", "links": "https://man.openbsd.org/pf", "content": ". I thought I\nwas going to use it, but I read a\n", "images": []},
{"title": "missing", "links": "https://man.openbsd.org/ospf6d", "content": " of\n", "images": []},
{"title": "missing", "links": "https://man.openbsd.org/eigrpd", "content": " the\nauthor of sidekiq and it made me realize I didn't need such a complex tool.", "images": []},
{"title": "missing", "links": "https://man.openbsd.org/bgpd", "content": "For shits and giggles, I initially thought \"wouldn't it be nice to use tree(1)\nto see everything??\". I created directories for blocks, and files for\naddresses. Here's what it looked like:", "images": []},
{"title": "missing", "links": "#software", "content": "Note: This predates the move to the feda netblock.", "images": []},
{"title": "missing", "links": "https://www.openbgpd.org/", "content": "However in the end, editing files was not easy because I had to escape all the\n", "images": []},
{"title": "missing", "links": "https://rpki-client.org/", "content": " in my shell. I had a lot of fun creating this arborescence, but it was time\nto move on to something more practical.", "images": []},
{"title": "missing", "links": "#rpki", "content": "I went for a single text file in a json-inspired format. Here's what it looks\nlike:", "images": []},
{"title": "missing", "links": "https://man.openbsd.org/rpki-client", "content": "Note that here RTBH is ", "images": []},
{"title": "missing", "links": "https://datatracker.ietf.org/doc/html/rfc8210", "content": " how I named the network, it's not related to\nactual RTBH.", "images": []},
{"title": "missing", "links": "https://github.com/cloudflare/gortr", "content": "I manage the file with vim and I can easily (un)fold any level whether I want\nan overview or a detailed view. Also this may not be entirely up to date haha.", "images": []},
{"title": "missing", "links": "https://github.com/bgp/stayrtr", "content": "My initial plan was to get some VMs around the world and announce the /48 on\neach.  Easier said than done, because my requirements are to find a provider\nwhich:", "images": []},
{"title": "missing", "links": "#contributions", "content": "I thought \"anycast is easy, you just announce your IP everywhere, and done\".\nWell, yes, but actually no. At least if you don't want to abide by ", "images": []},
{"title": "missing", "links": "https://github.com/openbsd/src/commit/d5980c09d2040665450fb05dc517f02f9059b40f", "content": ". Proper routing requires a\nlot of work.", "images": []},
{"title": "missing", "links": "https://github.com/openbsd/src/commit/7d9b2f2f77bea0095e5af3377fe49c9b1ba47384", "content": "I currently have 4 VMs in this anycast network:", "images": []},
{"title": "missing", "links": "https://github.com/openbsd/src/commit/25b45e4dc40bdb93a2214908573405fd6d7e5dc5", "content": "This is a work in progress that probably deserves its own blog post when it's\nfully done, so I won't go further into details.", "images": []},
{"title": "missing", "links": "https://github.com/openbsd/src/commit/f2c1f8a9d7d9a1bd6d0f1bd24202767c14a55827", "content": "As you just read, I have two VMs in Toronto. I wish I could have a provider in\nMontreal to reduce latency, unfortunately I've not been able to find one quite\nyet.", "images": []},
{"title": "missing", "links": "https://github.com/openbsd/ports/commit/824909a45fdb9566129f108c664aacfa148d71ca", "content": "I had to choose some tunnelling technology. I picked up WireGuard\u00ae because it\nhad recently made it into OpenBSD kernels (see\n", "images": []},
{"title": "missing", "links": "https://github.com/openbsd/src/commit/40192866049d58ca33971afdcb144fab8b38563c", "content": ") and my experience with ipsec is as \"good\"\nas the next person.", "images": []},
{"title": "missing", "links": "#cost", "content": "My current setup is:", "images": []},
{"title": "missing", "links": "#admincost", "content": "R1 and R2 are my VMs in Toronto, and R3 is my router at home. Yes, my router at\nhome uses BGP, both to announce its own netblock over BGP and to choose the\nbest route between R1+Upstream 1 and R2+Upstream 2. Isn't that super cool??! :D", "images": []},
{"title": "missing", "links": "#hostingcost", "content": "R1 and R2 both announce my /48 to their provider. They do so with my public\nASN.", "images": []},
{"title": "missing", "links": "https://evolix.com/", "content": "They have a wg link between each other. The goal is twofold:", "images": []},
{"title": "missing", "links": "#resources", "content": "Case 1 isn't actually a problem. Once the session with the upstream fails, it\nwon't get the ", "images": []},
{"title": "missing", "links": "#te", "content": "\nanymore, which means R3 won't get the full view from that router, and it will\n", "images": []},
{"title": "missing", "links": "https://www.youtube.com/watch?v=1pi18uNqsO4&list=PLjVwd8FlHBAQk5U2ScrjpeRJujGTCaMfR", "content": " traffic only to the other. Traffic ", "images": []},
{"title": "missing", "links": "https://nsrc.org/", "content": " will switch automatically\nprovided the upstream stops announcing my route (it should, but ", "images": []},
{"title": "missing", "links": "#findinghosters", "content": ")", "images": []},
{"title": "missing", "links": "http://bgp.services", "content": "I prepend that path with my ASN 15 times (picked by \"should be good enough\nlol\") to avoid using it in normal condition.", "images": []},
{"title": "missing", "links": "#shouldyoudoit", "content": "This simple link was actually quite a big change because until then, R1 and R2\nused to do some stateful firewalling (in addition to the one done on R3).\nHowever, this change meant traffic could flow asymmetrically, so I had to\nswitch to stateless firewall (which I restricted to the specific network, the\nrest of the traffic is still checked by ", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Content-addressable_memory#Ternary_CAMs", "content": "\nwith stateful rules).", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Default-free_zone", "content": "R3 announces the /56 I have at home over BGP to R1 and R2. \"But this is inter\nAS, why didn't you use an IGP???\". Well wg(4) doesn't support multicast, and\n", "images": []},
{"title": "missing", "links": "https://dn42.eu/Home", "content": " (and even\n", "images": []},
{"title": "missing", "links": "#outro", "content": ") needs it. You can do without\nbuuuut... I tried and struggled with ospf6d, so sticking with\n", "images": []},
{"title": "missing", "links": "https://en.wikipedia.org/wiki/Black_hole_(networking)#Black_hole_filtering", "content": " was way easier.", "images": []},
{"title": "missing", "links": "https://github.com/danieljakots/chownmeblog", "content": "Fun fact: I even began to write my own igpd, but I quickly realized I was just\nreimplementing bgpd poorly so I aborted.", "images": []},
{"title": "missing", "links": "missing", "content": "I actually use a private ASN to announce the /56. I picked 4200211935, so it's\nobviously both \"it's my ASN\", and \"it's not ", "images": []},
{"title": "missing", "links": "missing", "content": "\":", "images": []},
{"title": "missing", "links": "missing", "content": "Of course since I announce a /56 and a private ASN, I needed to stop checking\nRPKI for this particular host. Fortunately, bgpd's rules system is really easy\nto work with.", "images": []},
{"title": "missing", "links": "missing", "content": "Of course everything runs OpenBSD! It has a lovely\n", "images": []},
{"title": "missing", "links": "missing", "content": " in base. OpenBSD ships\n", "images": []},
{"title": "missing", "links": "missing", "content": " which one can use to validate ROA\n(\"improve the routing security\" in layman's terms).", "images": []},
{"title": "missing", "links": "missing", "content": "OpenBSD developers changed OpenBGPD config since last I used it. The thing I\nworry the most about is messing what I announce to my peers. They must have\nfilters, but I don't want to be ", "images": []},
{"title": "missing", "links": "missing", "content": ". OpenBGPD's config file is set in a\nway that it's hard to mess up, thanks to sane defaults and a nice logic.", "images": []},
{"title": "missing", "links": "missing", "content": "It ships with an excellent example config file making easy to start using it!\nFor that reason, I'm not going to detail mine.", "images": []},
{"title": "missing", "links": "missing", "content": "OpenBGPD uses little memory:", "images": []},
{"title": "missing", "links": "missing", "content": "Most VMs have only 1G of ram and 1 cpu.", "images": []},
{"title": "missing", "links": "missing", "content": "I didn't want to run ", "images": []},
{"title": "missing", "links": "missing", "content": " on each\nand every router. I couldn't either because it uses a truckload of inodes and\nmy /var/ partitions couldn't afford it.", "images": []},
{"title": "missing", "links": "missing", "content": "I considered using ", "images": []},
{"title": "missing", "links": "missing", "content": ",\nhowever it meant running more software (e.g.\n", "images": []},
{"title": "missing", "links": "missing", "content": "/", "images": []},
{"title": "missing", "links": "missing", "content": ").", "images": []},
{"title": "missing", "links": "missing", "content": "Also bgpd doesn't support (yet?) encrypted RTR so it would have meant either\ndoing RTR unecrypted (yuck), or run even more software.", "images": []},
{"title": "missing", "links": "missing", "content": "What I ended up doing is running rpki-client on my web server (on which I added\na special partion with way more inodes).", "images": []},
{"title": "missing", "links": "missing", "content": "And on my bgpd routers", "images": []},
{"title": "missing", "links": "missing", "content": "15 minutes ought to be enough, it used to run in 5 minutes, but apparently it\nnow runs in around 8 minutes, I guess I should setup some monitoring haha.", "images": []},
{"title": "missing", "links": "missing", "content": "Of course, I found some improvements for the software I use through this\nproject. Here are some fixes that made it into the OpenBSD trees because of my\nplaying around:", "images": []},
{"title": "missing", "links": "missing", "content": "Of course this weird hobby of mine costs money. I'm however very happy of how\nlow I could keep my expenses.", "images": []},
{"title": "missing", "links": "missing", "content": "Here's what I paid Grifon:", "images": []},
{"title": "missing", "links": "missing", "content": "Out of 4 VMs I run BGP on, I've been using one for other things, so I'm not\ncounting it since I would pay for it regardless of this project.", "images": []},
{"title": "missing", "links": "missing", "content": "Here's what I pay for the host:", "images": []},
{"title": "missing", "links": "missing", "content": "Even if I messed around with BGP before, I hadn't really gone deeper than the\nsurface. Since I had a lot to learn network engineering-wise, I read a lot of\nstuff. Among everything, I highly recommend the ", "images": []},
{"title": "missing", "links": "missing", "content": "\nfrom ", "images": []},
{"title": "missing", "links": "missing", "content": "The Google Docs ", "images": []},
{"title": "missing", "links": "missing", "content": " was\nincredibly helpful.", "images": []},
{"title": "missing", "links": "missing", "content": "Probably no.", "images": []},
{"title": "missing", "links": "missing", "content": "While the resources I'm using are plentiful (32-bit ASNs, 128-bit IP\naddresses), people's routers\n", "images": []},
{"title": "missing", "links": "missing", "content": "\nare not.", "images": []},
{"title": "missing", "links": "missing", "content": "My 'experiment' is 3 netblocks out of the ~130k in the\n", "images": []},
{"title": "missing", "links": "missing", "content": ".", "images": []},
{"title": "missing", "links": "missing", "content": "Note that I'm definitely not the first person to get an ASN for personal use.\nOnce you begin looking into ASN, there are plenty.", "images": []},
{"title": "missing", "links": "missing", "content": "If you really want to play with BGP, you can look into\n", "images": []},
{"title": "missing", "links": "missing", "content": "!", "images": []},
{"title": "missing", "links": "missing", "content": "I've been doing this project for a bit over a year now.", "images": []},
{"title": "missing", "links": "missing", "content": "There were some boring tasks (the perpetual quest to find hosters who don't\nsuck, administrative things to get the resources, etc), but overall, this\nproject has been incredibly fun!", "images": []},
{"title": "missing", "links": "missing", "content": "Yeah sex is good, but have you tried running mtr(8), while shutting a BGP\nsession, or ", "images": []},
{"title": "missing", "links": "missing", "content": "\nand watch the traffic change?", "images": []},
{"title": "missing", "links": "missing", "content": "This website is best viewed on a screen identical to my own. ", "images": []}
]